import{a6 as E,u as B,a7 as I,V as T,r as w,j as s,U as P,C as L,M as R,Q as _,O as A,a8 as F,T as M}from"./index-9bMVTCwX.js";import{R as H,C as N}from"./Row-DHyPlMXB.js";import{C as r}from"./Card-BHA5EGH-.js";import{A as d}from"./Accordion-IYSK-wA_.js";import{B as K}from"./Badge-BqfGFKAQ.js";import{T as k}from"./Table-DXOjfKuV.js";function V(){var h,j;const{id:l}=E(),{players:o}=B(),f=o==null?void 0:o.filter(e=>(e==null?void 0:e.name)!=="LIBRE"),y=new Map(f.map(e=>[e.id,e.name])),m=e=>y.get(e)||"-",b=I(),{tournaments:u}=b.state||{},a=u.find(e=>e.id===Number.parseInt(l)),{data:c=[],isLoading:C,isError:x}=T({queryKey:["standings",l],queryFn:async()=>{console.log("Fetching tournament matches from API...");const e=await fetch(`https://fao-backend.onrender.com/tournament/${l}/standings`);if(!e.ok)throw new Error("Error al cargar la página");return await e.json()},staleTime:1e3*60*20,cacheTime:1e3*60*30,refetchOnWindowFocus:!1}),i=c==null?void 0:c.filter(e=>(e==null?void 0:e.player_name)!=="LIBRE");return w.useEffect(()=>{console.log(c)},[l,c]),x?s.jsxs(P,{children:["Error: ",x]}):s.jsx("div",{children:s.jsx("div",{children:a!==void 0?s.jsx(L,{className:"tournament-detail-container",children:s.jsxs(H,{className:"justify-content-center",children:[s.jsxs(N,{xs:12,lg:8,children:[s.jsxs(r,{className:"tournament-detail-card mb-4",children:[s.jsx(r.Header,{children:s.jsx("h2",{className:"mb-0",children:a==null?void 0:a.name})}),s.jsxs(r.Body,{children:[s.jsxs(r.Text,{children:[s.jsx(R,{className:"me-2"}),s.jsxs("strong",{children:["Lugar: ",a==null?void 0:a.location]})," "]}),s.jsxs(r.Text,{children:[s.jsx(_,{className:"me-2"}),s.jsxs("strong",{children:["Fecha de inicio: ",a==null?void 0:a.start_date]})," "]})]})]}),s.jsx(d,{className:"rounds-accordion mb-4",children:((h=a==null?void 0:a.rounds)==null?void 0:h.length)>0&&((j=a.rounds)==null?void 0:j.map((e,t)=>{var p,g;return s.jsxs(d.Item,{className:"rounds-item",eventKey:t.toString(),children:[s.jsx(d.Header,{className:"rounds-header",children:s.jsxs("h5",{className:"mb-0",children:[s.jsx(A,{className:"me-2"}),"Ronda ",e==null?void 0:e.number]})}),s.jsx(d.Body,{children:((p=e==null?void 0:e.matches)==null?void 0:p.length)>0&&((g=e==null?void 0:e.matches)==null?void 0:g.map((n,v)=>s.jsx(r,{className:"match-card mb-2",children:s.jsx(r.Body,{children:s.jsxs("div",{className:"players-container",children:[s.jsx("span",{className:"player-name",children:m(n==null?void 0:n.player1_id)}),s.jsx(K,{bg:"secondary",className:"result-badge",children:n==null?void 0:n.result}),s.jsx("span",{className:"player-name",children:m(n==null?void 0:n.player2_id)})]})})},v)))})]},e==null?void 0:e.number)}))})]}),s.jsx(N,{xs:12,lg:4,children:C?s.jsxs("div",{className:"div-spinner",children:[s.jsx(F,{}),s.jsx("p",{children:"Cargando clasificación"})]}):s.jsxs(r,{className:"standings-card",children:[s.jsx(r.Header,{children:s.jsx("h3",{className:"mb-0",children:"Clasificación"})}),s.jsx(r.Body,{children:s.jsxs(k,{striped:!0,bordered:!0,hover:!0,responsive:!0,className:"standings-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Jugador"}),s.jsx("th",{children:"Puntos"})]})}),s.jsx("tbody",{children:(i==null?void 0:i.length)>0&&(i==null?void 0:i.map((e,t)=>s.jsxs("tr",{children:[s.jsx("td",{children:e.player_name}),s.jsx("td",{children:e.points})]},t)))})]})})]})})]})}):s.jsx(M,{msg:"Cargando torneo"})})})}export{V as default};
