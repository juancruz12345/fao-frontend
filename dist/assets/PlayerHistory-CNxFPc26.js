import{r as o,P as g,j as e,z as u,y as j,a3 as U,a4 as Y,M as Z,O as P,C as ee,a9 as se,aa as ae}from"./index-BKcmjB81.js";import{C as x}from"./Card-Kh-DD9Gn.js";import{T as re}from"./Table-LajqTO9z.js";import{C as T,R as _}from"./Row-CY8um4bv.js";import"./warning-OHwVOzV5.js";import{B as O}from"./Button-KNiCUiRh.js";import{B as te}from"./Badge-CbdyvGZ7.js";function oe(s,a){return o.Children.toArray(s).some(r=>o.isValidElement(r)&&r.type===a)}const ne={type:g.string,tooltip:g.bool,as:g.elementType},$=o.forwardRef(({as:s="div",className:a,type:r="valid",tooltip:n=!1,...t},l)=>e.jsx(s,{...t,ref:l,className:u(a,`${r}-${n?"tooltip":"feedback"}`)}));$.displayName="Feedback";$.propTypes=ne;const f=o.createContext({}),I=o.forwardRef(({id:s,bsPrefix:a,className:r,type:n="checkbox",isValid:t=!1,isInvalid:l=!1,as:d="input",...h},p)=>{const{controlId:m}=o.useContext(f);return a=j(a,"form-check-input"),e.jsx(d,{...h,ref:p,type:n,id:s||m,className:u(r,a,t&&"is-valid",l&&"is-invalid")})});I.displayName="FormCheckInput";const R=o.forwardRef(({bsPrefix:s,className:a,htmlFor:r,...n},t)=>{const{controlId:l}=o.useContext(f);return s=j(s,"form-check-label"),e.jsx("label",{...n,ref:t,htmlFor:r||l,className:u(a,s)})});R.displayName="FormCheckLabel";const G=o.forwardRef(({id:s,bsPrefix:a,bsSwitchPrefix:r,inline:n=!1,reverse:t=!1,disabled:l=!1,isValid:d=!1,isInvalid:h=!1,feedbackTooltip:p=!1,feedback:m,feedbackType:i,className:C,style:w,title:F="",type:v="checkbox",label:y,children:c,as:L="input",...Q},W)=>{a=j(a,"form-check"),r=j(r,"form-switch");const{controlId:B}=o.useContext(f),X=o.useMemo(()=>({controlId:s||B}),[B,s]),E=!c&&y!=null&&y!==!1||oe(c,R),J=e.jsx(I,{...Q,type:v==="switch"?"checkbox":v,ref:W,isValid:d,isInvalid:h,disabled:l,as:L});return e.jsx(f.Provider,{value:X,children:e.jsx("div",{style:w,className:u(C,E&&a,n&&`${a}-inline`,t&&`${a}-reverse`,v==="switch"&&r),children:c||e.jsxs(e.Fragment,{children:[J,E&&e.jsx(R,{title:F,children:y}),m&&e.jsx($,{type:i,tooltip:p,children:m})]})})})});G.displayName="FormCheck";const k=Object.assign(G,{Input:I,Label:R}),M=o.forwardRef(({bsPrefix:s,type:a,size:r,htmlSize:n,id:t,className:l,isValid:d=!1,isInvalid:h=!1,plaintext:p,readOnly:m,as:i="input",...C},w)=>{const{controlId:F}=o.useContext(f);return s=j(s,"form-control"),e.jsx(i,{...C,type:a,size:n,ref:w,readOnly:m,id:t||F,className:u(l,p?`${s}-plaintext`:s,r&&`${s}-${r}`,a==="color"&&`${s}-color`,d&&"is-valid",h&&"is-invalid")})});M.displayName="FormControl";const le=Object.assign(M,{Feedback:$}),V=o.forwardRef(({className:s,bsPrefix:a,as:r="div",...n},t)=>(a=j(a,"form-floating"),e.jsx(r,{ref:t,className:u(s,a),...n})));V.displayName="FormFloating";const b=o.forwardRef(({controlId:s,as:a="div",...r},n)=>{const t=o.useMemo(()=>({controlId:s}),[s]);return e.jsx(f.Provider,{value:t,children:e.jsx(a,{...r,ref:n})})});b.displayName="FormGroup";const z=o.forwardRef(({as:s="label",bsPrefix:a,column:r=!1,visuallyHidden:n=!1,className:t,htmlFor:l,...d},h)=>{const{controlId:p}=o.useContext(f);a=j(a,"form-label");let m="col-form-label";typeof r=="string"&&(m=`${m} ${m}-${r}`);const i=u(t,a,n&&"visually-hidden",r&&m);return l=l||p,r?e.jsx(T,{ref:h,as:"label",className:i,htmlFor:l,...d}):e.jsx(s,{ref:h,className:i,htmlFor:l,...d})});z.displayName="FormLabel";const A=o.forwardRef(({bsPrefix:s,className:a,id:r,...n},t)=>{const{controlId:l}=o.useContext(f);return s=j(s,"form-range"),e.jsx("input",{...n,type:"range",ref:t,className:u(a,s),id:r||l})});A.displayName="FormRange";const D=o.forwardRef(({bsPrefix:s,size:a,htmlSize:r,className:n,isValid:t=!1,isInvalid:l=!1,id:d,...h},p)=>{const{controlId:m}=o.useContext(f);return s=j(s,"form-select"),e.jsx("select",{...h,size:r,ref:p,className:u(n,s,a&&`${s}-${a}`,t&&"is-valid",l&&"is-invalid"),id:d||m})});D.displayName="FormSelect";const q=o.forwardRef(({bsPrefix:s,className:a,as:r="small",muted:n,...t},l)=>(s=j(s,"form-text"),e.jsx(r,{...t,ref:l,className:u(a,s,n&&"text-muted")})));q.displayName="FormText";const H=o.forwardRef((s,a)=>e.jsx(k,{...s,ref:a,type:"switch"}));H.displayName="Switch";const ce=Object.assign(H,{Input:k.Input,Label:k.Label}),K=o.forwardRef(({bsPrefix:s,className:a,children:r,controlId:n,label:t,...l},d)=>(s=j(s,"form-floating"),e.jsxs(b,{ref:d,className:u(a,s),controlId:n,...l,children:[r,e.jsx("label",{htmlFor:n,children:t})]})));K.displayName="FloatingLabel";const ie={_ref:g.any,validated:g.bool,as:g.elementType},S=o.forwardRef(({className:s,validated:a,as:r="form",...n},t)=>e.jsx(r,{...n,ref:t,className:u(s,a&&"was-validated")}));S.displayName="Form";S.propTypes=ie;const N=Object.assign(S,{Group:b,Control:le,Floating:V,Check:k,Switch:ce,Label:z,Text:q,Range:A,Select:D,FloatingLabel:K});function fe(){var y;const{id:s}=U(),a=Y(),{players:r}=a.state||{},n=r.find(c=>c.id===parseInt(s)),[t,l]=o.useState(""),[d,h]=o.useState(""),[p,m]=o.useState([]),{data:i=[],isLoading:C,isError:w}=Z({queryKey:["player_history",s],queryFn:async()=>{const c=await fetch(`https://fao-backend.onrender.com/player/${s}/matches`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!c.ok)throw new Error("Error al cargar la página");return c.json()},staleTime:1e3*60*20,cacheTime:1e3*60*30,refetchOnWindowFocus:!1}),F=()=>{if(!i.matches)return;const c=i.matches.filter(L=>(t===""||L.player1_name.toLowerCase().includes(t.toLowerCase())||L.player2_name.toLowerCase().includes(t.toLowerCase()))&&(d===""||L.tournament_name.toLowerCase().includes(d.toLowerCase())));m(c)},v=()=>{l(""),h(""),m([])};return C?e.jsx(P,{msg:"Cargando historial"}):w?e.jsx("div",{className:"text-center text-danger",children:"Error al cargar el historial del jugador"}):e.jsxs(ee,{className:"py-5",children:[e.jsx("h1",{className:"mb-4",children:n.name}),Array.isArray(i)&&((y=i==null?void 0:i.matches)==null?void 0:y.length)>0?e.jsxs("div",{children:[e.jsxs(x,{className:"mb-4",children:[e.jsx(x.Header,{children:e.jsx(x.Title,{children:"Estadísticas"})}),e.jsx(x.Body,{children:e.jsxs(re,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Victorias"}),e.jsx("th",{children:"Empates"}),e.jsx("th",{children:"Derrotas"})]})}),e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{children:i.totalVictories}),e.jsx("td",{children:i.totalDraws}),e.jsx("td",{children:i.totalDefeats})]})})]})})]}),e.jsx(x,{className:"mb-4",children:e.jsx(x.Body,{children:e.jsxs(_,{className:"g-3",children:[e.jsx(T,{xs:12,sm:6,md:4,children:e.jsxs(N.Group,{children:[e.jsx(N.Label,{children:"Buscar por jugador"}),e.jsx(N.Control,{type:"text",placeholder:"Nombre del jugador",value:t,onChange:c=>l(c.target.value)})]})}),e.jsx(T,{xs:12,sm:6,md:4,children:e.jsxs(N.Group,{children:[e.jsx(N.Label,{children:"Buscar por torneo"}),e.jsx(N.Control,{type:"text",placeholder:"Nombre del torneo",value:d,onChange:c=>h(c.target.value)})]})}),e.jsx(T,{xs:12,md:4,className:"d-flex align-items-end",children:e.jsxs("div",{className:"d-flex gap-2 flex-grow-1",children:[e.jsxs(O,{variant:"primary",onClick:F,className:"flex-grow-1",children:[e.jsx(se,{size:20,className:"me-2"}),"Buscar"]}),e.jsxs(O,{variant:"outline-secondary",onClick:v,className:"flex-grow-1",children:[e.jsx(ae,{size:20,className:"me-2"}),"Limpiar"]})]})})]})})}),e.jsx(_,{xs:1,md:2,lg:3,className:"g-4",children:(p.length>0?p:i.matches).map(c=>e.jsx(T,{children:e.jsxs(x,{className:"h-100",children:[e.jsxs(x.Header,{children:[e.jsxs(x.Title,{className:"h5 mb-0",children:["Torneo: ",c.tournament_name]}),e.jsxs(x.Subtitle,{className:"mt-1 text-muted",children:["Ronda: ",c.round_number]})]}),e.jsx(x.Body,{children:e.jsxs("div",{className:"match-result",children:[e.jsx("span",{className:"player-name",children:c.player1_name}),e.jsx(te,{bg:"secondary",className:"mx-2",children:c.result}),e.jsx("span",{className:"player-name",children:c.player2_name})]})})]})},c.match_id))})]}):e.jsx("h2",{children:"No hay historial"})]})}export{fe as default};
